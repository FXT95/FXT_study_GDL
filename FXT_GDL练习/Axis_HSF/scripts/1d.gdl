!!!第二道尺寸线尺寸Arr_dis_All=0For i=1 to amount	Arr_dis_All=Arr_dis_All+Arr_dis[i]NEXT i	!!!!!scale dimention   	-------------------------------------		缩放尺寸大小------------------------Axis_and_dim_distance=Axis_and_dim_distance*GlOB_SCALE/100Dim_distance_Y=Dim_distance_Y*GlOB_SCALE/100!----------------------!!!!!轴网空间位置----影响尺寸标注与尺寸线的甚--------------------------------------!!!!!SYMB_ROTANGLE			rotation angle of the library part!!!!numeric rotation from within the settings dialog is performed around the current anchor point+!!!获取当前窗口  旋转角度!!!!!n = REQUEST ("view_rotangle", "", angleViewRotation)!!!!!Returns the rotation angle of the current view. Expression returns 0 and contains dummy return values (emtpy string or 0) if used in parameter script, causing!!!!!additional warning.This_View_Rotation=0n = REQUEST ("view_rotangle", "", This_View_Rotation)This_Lib_Rotate=SYMB_ROTANGLE+This_View_Rotation			!IF	This_Lib_Rotate>=360 THEN	This_lib_Rotate=This_lib_Rotate-360					!!!!防止视图转动过大  两数加起来超过一个周期   Dim_mir=1IF This_Lib_Rotate>325 or This_Lib_Rotate<=135	THEN	Dim_mir=0!!----------------------------------------------------------------------------------------------------------------------------------------------------!-----------------------------------------------------!标注字体状态选择!"加粗","斜体","下划线","上标","下标","删除线"IF Font_DIm_Face=""		THEN			Dim_Face_Code=0	ENDIFIF Font_DIm_Face="加粗"		THEN			Dim_Face_Code=1	ENDIFIF Font_DIm_Face="斜体"		THEN			Dim_Face_Code=2	ENDIFIF Font_DIm_Face="下划线"		THEN			Dim_Face_Code=4	ENDIFIF Font_DIm_Face="上标"		THEN			Dim_Face_Code=32	ENDIFIF Font_DIm_Face="下标"		THEN			Dim_Face_Code=64	ENDIFIF Font_DIm_Face="删除线"	THEN			Dim_Face_Code=128	ENDIF!------------------------------------------------------------!!!change the distance between two axis when "GLOB_MODPAR_NAME"change---------------------------------------------------------IF   GLOB_MODPAR_NAME="amount"	THEN								!参数改变触发条件为 数量改变	if  VARDIM1(Arr_dis)<=amount THEN											FOR i=VARDIM1(Arr_dis)+1 TO amount								!在初始数组的基础上增加数据     初始数组会在每次 检测到amount改变是 而产生改变			parameters Arr_dis[i]=dis											!返回值给列表		NEXT i	ELSE 		FOR i=amount+1 to VARDIM1(Arr_dis)								!当初始列表大于需求的数量 amount时  将后面的数值请零  ////////如果能够删掉最好  目前不知道怎么操作		parameters Arr_dis[i]=0		NEXT i	ENDIF	FOR i=1 TO amount															! 在上面归零操作后   会出现“0”数值  轴网重合  为了避免情况发生  特此设置   同时为了防止 用户误操作 将轴网放置太近（误认为一个轴网） 目前控制范围为100mm  可酌情调大!		IF Arr_dis[i]<=0.1 THEN			parameters Arr_dis[i]=dis		ENDIF	NEXT iENDIF!-------------------------------------------------------------------------------------------------------------------------------	!!!change the length of axis when "GLOB_MODPAR_NAME"change---------------------------------------------------------for  axis hotspot   !同上操作  轴线间距 换成了   轴线的长度IF   GLOB_MODPAR_NAME="amount"	THEN	if  VARDIM1(Arr_Axis_lenth)<=amount+1 THEN		FOR i=VARDIM1(Arr_Axis_lenth)+1 TO amount+1		parameters Arr_Axis_lenth[i]=Axis_lenth		NEXT i!	ELSE !!		FOR i=amount+2 to VARDIM1(Arr_Axis_lenth)!		parameters Arr_Axis_lenth[i]=0!		NEXT i	ENDIF	FOR i=1 TO amount+1		IF Arr_Axis_lenth[i]<=0.1 THEN			parameters Arr_Axis_lenth[i]=Axis_lenth		ENDIF	NEXT iENDIFIF GLOB_MODPAR_NAME="Axis_lenth" THEN									!增加一个可同时控制所有轴线的端口   弊端就是会让所有轴线同长度     再考虑要不要开一个条件判断来  是统一直接加长  还是 全部变成一样长  理论可实现	FOR i=1 TO amount+1		parameters Arr_Axis_lenth[i]=Axis_lenth		NEXT iENDIF!-------------------------------------------------------------------------------------------------------------------------------	!!!!change the length of axis when "GLOB_MODPAR_NAME"change---------------------------------------------------------for  axis hotspot   !同上操作  轴线间距 换成了  标注文字位置y!IF   GLOB_MODPAR_NAME="amount"	THEN!	if  VARDIM1(Arr_Axis_lenth)<=amount THEN!		FOR i=VARDIM1(Arr_Dim_distance_Y)+1 TO amount!		parameters Arr_Dim_distance_Y[i]=Dim_distance_Y!		NEXT i!	ELSE !!		FOR i=amount+1 to VARDIM1(Arr_Dim_distance_Y)!		parameters Arr_Dim_distance_Y[i]=0!		NEXT i!	ENDIF!	FOR i=1 TO amount!		IF Arr_Dim_distance_Y[i]<=0.01 THEN						!最小10mm移动!			parameters Arr_Dim_distance_Y[i]=Dim_distance_Y!		ENDIF!	NEXT i!ENDIF!!!!IF GLOB_MODPAR_NAME="Dim_distance_Y" THEN									!	FOR i=1 TO amount!		parameters Arr_Dim_distance_Y[i]=Dim_distance_Y!		NEXT i!ENDIF!!-------------------------------------------------------------------------------------------------------------------------------	!!!change the length of axis when "GLOB_MODPAR_NAME"change---------------------------------------------------------for  axis hotspot   !同上操作  轴线间距 换成了  标注文字位置x!IF   GLOB_MODPAR_NAME="amount"	THEN!	if  VARDIM1(Arr_Axis_lenth)<=amount THEN!		FOR i=VARDIM1(Arr_Dim_distance_Y)+1 TO amount!		parameters Arr_Dim_distance_X[i]=Arr_dis[i]/2!		NEXT i!	ELSE !!		FOR i=amount+1 to VARDIM1(Arr_Dim_distance_X)!		parameters Arr_Dim_distance_X[i]=0!		NEXT i!	ENDIF!	FOR i=1 TO amount!		IF Arr_Dim_distance_X[i]<=0.01 THEN						!最小10mm移动!			parameters Arr_Dim_distance_Y[i]=Arr_dis[i]/2!		ENDIF!	NEXT i!ENDIF!-------------------------------------------------------------------------------------------------------------------------------	