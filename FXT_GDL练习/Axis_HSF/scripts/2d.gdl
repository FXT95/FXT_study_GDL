!!!!!---------------------------------------------------调用全局标注参数!-----------------------------------------------------------------SizeFormat = ""n = REQUEST ("LINEAR_DIMENSION", "", SizeFormat)!axis----------------------------------------------------------------------------------------UNID=10000FOR i =1 to amount+1									!轴线数量会比间距多一个	!hotspot	IF i <>1	THEN										!因为轴网会多一个 但是坐标转换比轴网少一次 所以需要回退一个		ADD2 Arr_dis[i-1],0	ENDIF	IF i<=amount	THEN		HOTSPOT2 	-1,	0,	UNID=UNID+1,	Arr_dis[i],	3		HOTSPOT2 	0,	0,	UNID=UNID+1,	Arr_dis[i],	1		HOTSPOT2 	Arr_dis[i],	0,	UNID=UNID+1,	Arr_dis[i],	2	ENDIF!Axis	GOSUB "Axis"!dimension	ADD2 0,-(Axis_lenth_extend+Axis_and_dim_distance+Axis_and_dim_distance)																		!轴网标注与轴线的距离     轴网延申距离+周线末端距轴网距离（暂时定和轴线长度相等）+轴线长度！	IF i<=amount	THEN		Axis_distance=Arr_dis[i]				!"dimension"  需要的函数参数											!"dimension"  需要的函数参数		GOSUB"Dimension"	ENDIF	DEL 1	GOSUB	"Number of Axis"	NEXT idel amount			!删除坐标移动次数!第二道尺寸线				The second dimensionADD2 0,-(Axis_lenth_extend+Axis_and_dim_distance+Axis_and_dim_distance+	Axis_and_dim_distance)Axis_distance=Arr_dis_AllY_Dim_Distance=Dim_distance_YGOSUB"Dimension"Del 1END!--------------------------------------------------------------------------------------------------------------------!--------------------------------------------------------------------------------------------------------------------"Axis":	line_type Axis_Line_type													!轴线线型	line2 0,-Axis_lenth_extend,0,Arr_Axis_lenth[i]								!轴线长度!hotline	HOTLINE2 0,-Axis_lenth_extend,0,Arr_Axis_lenth[i]!hotspots	HOTSPOT2 	-1,	0,	UNID=UNID+1,	Arr_Axis_lenth[i],	3+128	HOTSPOT2 	0,	0,	UNID=UNID+1,	Arr_Axis_lenth[i],	1	HOTSPOT2 	0,	Arr_Axis_lenth[i],	UNID=UNID+1,	Arr_Axis_lenth[i],	2!GLOBAL hotspot   //当他改变时候 所有 hotspot和他统一	IF i <=amount THEN																!同样是轴线间距比轴网个数少一个 amount+1 超出数组		HOTSPOT2 	Arr_dis[i]/2-1,	0,	UNID=UNID+1,	Axis_lenth,	3+128		HOTSPOT2 	Arr_dis[i]/2,	0,	UNID=UNID+1,	Axis_lenth,	1		HOTSPOT2 	Arr_dis[i]/2,	Axis_lenth,	UNID=UNID+1,	Axis_lenth,	2	ENDIFRETURN!--------------------------------------------------------------------------------------------------------------------!--------------------------------------------------------------------------------------------------------------------"Dimension":	line_type 1	PEN		Dim_Line_Pen!两边直线1	line2 0,		-0.2*GLOB_SCALE/100,		0,		Axis_and_dim_distance	ROT2 -45   !斜线1	line2 0,	-0.1*GLOB_SCALE/100,		0,		0.1*GLOB_SCALE/100	del 1!水平直线	line2 0,		0,		Axis_distance	,	0	ADD2		Axis_distance	,	0!两边直线1	line2 0,		-0.2,		0,		Axis_and_dim_distance	ROT2 -45   !斜线1	line2 0,	-0.1,		0,		0.1	del 2!文字	IF Dim_mir=1	THEN  MUL2 1,-1 			!!!控制轴网转动时  文字的方向和位置	Dim_String=STR (SizeFormat,	Axis_distance)		!通过全局参数来确定标注尺寸单位	GOSUB	"DimStyle"	GOSUB	"DimPARAGRAPH"	GOSUB	"DimTextblock"	Hotspot2 Axis_distance/2,0,unid=unid+1	RICHTEXT2 	Axis_distance/2,	Dim_distance_Y,	"DimTextblock"			IF Dim_mir=1	THEN	DEL	1				!!!删除控制文字方向的RETURN!--------------------------------------------------------------------------------------------------------------------!--------------------------------------------------------------------------------------------------------------------"Number of Axis":	LINE_TYPE	1		line2	0,0,0,-(Axis_lenth_extend+Axis_and_dim_distance+Axis_and_dim_distance+	Axis_and_dim_distance+Axis_and_dim_distance)	!!!!!!!距离控制  下个版本全部单独 距离控制 相互公式控制  目前太乱	ADD2	0,-(Axis_lenth_extend+Axis_and_dim_distance+Axis_and_dim_distance+	Axis_and_dim_distance+Axis_and_dim_distance)	Circle_r=0.5	Circle_r=Circle_r	*	GLOB_SCALE/100						!!!!随图纸比例变化	ADD2 0,-Circle_r	CIRCLE2		0,0,Circle_r	GOSUB	"NumberTextblock"	RICHTEXT2 	0,	-Font_Height/2*GLOB_SCALE/1000,	"NumberTextblock"		HOTSPOT2 0,0,UNID=UNID+1	DEL 2	RETURN!--------------------------------------------------------------------------------------------------------------------!--------------------------------------------------------------------------------------------------------------------!-------------------------------------------------创建文字样式-------------------------------------------------------------------"DimStyle":DEFINE STYLE{2} 	"DimStyle"	Font_name,		Font_Height,		Dim_Face_CodeRETURN !-------------------------------------------------------------------------------------------------------------------!----------------------------------创建文字格式----------------------------------------------------------------------------------"DimPARAGRAPH":	PARAGRAPH	"DimParagraph"	2,	0,	0,	0,	Font_Height*1		PEN		Font_Pen		STYLE		DimStyle	ENDPARAGRAPHRETURN!-------------------------------------------------------------------------------------------------------------------!----------------------------------文字 缩放 行间距----------------------------------------------------------------------------------"DimTextblock":			TEXTBLOCK		"DimTextblock"	0,	5,	0,	1,	1,	1,	Dim_StringRETURN!------------------------------------------------------------------------------------------------------------"NumberTextblock":		TEXTBLOCK		"NumberTextblock"	0,	5,	0,	1,	1,	1,	"口"RETURN